stages:
  - build

Build:
  stage: build
  image: ghcr.io/werf/werf
  script:
    - source <(werf ci-env gitlab)
    - werf build
  tags: ["kubernetes-runner-for-werf"]
  except:
    - main

Publish:
  stage: build
  image: ghcr.io/werf/werf
  script:
    - source <(werf ci-env gitlab)
    - werf bundle publish --tag 0.0.0-$CI_COMMIT_SHA
  tags: ["kubernetes-runner-for-werf"]
  only:
    - main
